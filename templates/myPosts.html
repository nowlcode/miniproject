<!DOCTYPE html>
<html lang="en">
  <head>
    <title>내 게시글</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>

    <!-- 구글폰트 -->
    <link
      href="https://fonts.googleapis.com/css?family=Stylish&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Jua&display=swap"
      rel="stylesheet"
    />

    <title>끼리끼리</title>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <h1>post detail</h1>
  </body>
</html>

<script>
  $(document).ready(function () {
    show_list();
  });
  function show_list() {
    $.ajax({
      type: "GET",
      url: "/posts/list",
      data: {},
      success: function (response) {
        let result = response["data"].reverse();
        for (let i = 0; i < result.length; i++) {
          const title = result[i]["title"];
          const content = result[i]["content"];
          const participants = result[i]["participants"];
          const dateTime = result[i]["date"];
          const partNum = result[i]["partNum"];
          const num = result[i]["num"];
          const done = result[i]["done"];

          let temp_html = ``;
          if ((done == 0) & (partNum < participants)) {
            temp_html = `<a href="#">
                                      <div class="col">
                                          <div class="card h-100">
                                              <img src= "../static/helloworld.png"
                                                   class="card-img-top" alt="...">
                                              <div class="card-body">
                                                  <h5 class="card-title">${title}</h5>
                                                  <h6>${content}</h6>
                                                  <p>${dateTime}</p>
                                              </div>
                                          </div>
                                          <div class="card-footer">
                                              <small class="text-muted">
                                                  <button onclick="participate(${num})" class="btn btn-primary">참가하기 [현재 숫자:
                                                      ${partNum}/${participants}]
                                                  </button>
                                              </small>
                                          </div>
                                      </div>
                                  </a>`;
            $("#post-card").append(temp_html);
          } else if (done == 1) {
            temp_html = `<a href="#">
                                      <div class="col">
                                          <div class="card h-100">
                                              <img src= "../static/helloworld.png"
                                                   class="card-img-top" alt="...">
                                              <div class="card-body">
                                                  <h5 class="card-title">${title}</h5>
                                                  <h6>${content}</h6>
                                                  <p>${dateTime}</p>
                                              </div>
                                          </div>
                                          <div class="card-footer">
                                              <small class="text-muted">
                                                  <button onclick="cancel(${num})" class="btn btn-danger">취소 [현재 숫자:
                                                      ${partNum}/${participants}]
                                                  </button>
                                              </small>
                                          </div>
                                      </div>
                                  </a>`;
            $("#post-card").append(temp_html);
          } else {
            temp_html = `<a href="#">
                                      <div class="col">
                                          <div class="card h-100">
                                              <img src= "../static/helloworld.png"
                                                   class="card-img-top" alt="...">
                                              <div class="card-body">
                                                  <h5 class="card-title">${title}</h5>
                                                  <h6>${content}</h6>
                                                  <p>${dateTime}</p>
                                              </div>
                                          </div>
                                          <div class="card-footer">
                                              <small class="text-muted">
                                                  <button onclick="complete(${num})" class="btn btn-warning">모든 인원 접수완료! [현재 숫자:
                                                      ${partNum}/${participants}]
                                                  </button>
                                              </small>
                                          </div>
                                      </div>
                                  </a>`;
            $("#post-card").append(temp_html);
          }
        }
      },
    });
  }
</script>
